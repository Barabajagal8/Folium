<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" href="css/styles.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.9.0/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyBfhX8hm-A3IAn2us9ybZiP_GWg-H-5sC8",
    authDomain: "folium-93435.firebaseapp.com",
    databaseURL: "https://folium-93435.firebaseio.com",
    projectId: "folium-93435",
    storageBucket: "folium-93435.appspot.com",
    messagingSenderId: "700685483452"
  };
  firebase.initializeApp(config);
</script>
	<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css" />

	<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
</head>
<body>
	<button onclick="download()">download</button>
	<button onclick="getMeta()">getMeta</button>
	<img id="myimg" src="">
	<p id="login"></p>
<script>
firebase.auth().onAuthStateChanged(function(user) {
	var user = firebase.auth().currentUser;
	var name;

	if (user != null) {
 		 name = user.displayName;
	}
    if (user) {
		document.getElementById("login").innerHTML = name;
    }else {
   	 console.log("Not signed in");
 	 }
});

function download () {
console.log(name);
	var storage = firebase.storage();
	var storageRef = storage.ref();
	storageRef.child(name + "/images/1554091375292-8c1.png").getDownloadURL().then(function(url) {
	  // `url` is the download URL for 'images/stars.jpg'

	  // This can be downloaded directly:
	  var xhr = new XMLHttpRequest();
	  xhr.responseType = 'blob';
	  xhr.onload = function(event) {
		var blob = xhr.response;
	  };
	  xhr.open('GET', url);
	  xhr.send();

	  // Or inserted into an <img> element:
	  var img = document.getElementById('myimg');
	  img.src = url;
	}).catch(function(error) {
		console.log("Something went wrong.");
	});
}
function getMeta() {
	var storage = firebase.storage();
	var storageRef = storage.ref();

	// Create a reference to the file whose metadata we want to retrieve
		var forestRef = storageRef.child(name + '/images/');
	console.log(forestRef);
	// Get metadata properties
	forestRef.getMetadata().then(function(metadata) {
	  // Metadata now contains the metadata for 'images/forest.jpg'
	}).catch(function(error) {
	  // Uh-oh, an error occurred!
	});
}
</script>
</body>
</html>
